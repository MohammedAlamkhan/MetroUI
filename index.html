<!DOCTYPE html>
<html>
	<head>
		<title>MetroUI 2.1 Technical Preview 2</title>
		<link rel="stylesheet" href="build/css/MetroUI-2.1.css"></link>
		<link rel="stylesheet" href="build/css/MetroUI.Win10.css"></link>

		<link rel="stylesheet" href="build/css/fonts.css"></link>
		<link rel="stylesheet" href="build/css/fonts-wp.css"></link>
		<link rel="stylesheet" href="build/css/swiper.min.css"></link>
		<meta name="viewport" content="width=device-width, user-scalable=no, initial-scale=1">
		<meta name="apple-mobile-web-app-capable" content="yes">
		<meta name="apple-mobile-web-app-title" content="MetroUI">

		<script src="build/js/MetroUI-2.1.js"></script>
		<script src="build/js/MetroUI.Win10.js"></script>
		<script src="build/js/swiper.min.js"></script>

		
		
		<script>
			document.addEventListener("DOMContentLoaded", function() {
			  var isInFullScreen = false;
			
			  function toggleFullScreen() {
				if (!isInFullScreen) {
				  if (document.documentElement.requestFullscreen) {
					document.documentElement.requestFullscreen();
				  } else if (document.documentElement.webkitRequestFullscreen) { /* Safari */
					document.documentElement.webkitRequestFullscreen();
				  } else if (document.documentElement.msRequestFullscreen) { /* IE11 */
					document.documentElement.msRequestFullscreen();
				  }
				  isInFullScreen = true;
				} else {
				  if (document.exitFullscreen) {
					document.exitFullscreen();
				  } else if (document.webkitExitFullscreen) { /* Safari */
					document.webkitExitFullscreen();
				  } else if (document.msExitFullscreen) { /* IE11 */
					document.msExitFullscreen();
				  }
				  isInFullScreen = false;
				}
			  }
			
			  // Trigger fullscreen mode when the page loads
			  toggleFullScreen();
			});
			</script>
		
		<style>
			body {
				-webkit-perspective: 200px;
/* 				background-image: -webkit-linear-gradient(#021952 0%, #005fb7 100%); */
				background-image: url(img/El%20Capitan.jpg);
				background-position: center center;
				background-size: cover;
				background-repeat: no-repeat;
			}
			div.tiles-preview:before {
				background-image: url(img/El%20Capitan.jpg) !important;
				background-size: cover !important;
			}

			footer div:before, p.label {
				-webkit-transform: translate3d(0, 0, 0)
			}
			footer div, div.tile {
				-webkit-transform: translate3d(0,0,0);
			}

			div.view.view-active {
				z-index: 1000;
			}
			div.view:not(#view-test) div.view-inner {
				background-color: #fff;
			}
			div.view, div.view-inner {
				position: absolute;
				width: 100%;
				height: 100%;
				-webkit-transform: translateZ(0);
			}

		</style>
	</head>
	<body data-tint-win="very-dark-purple" data-tint-wp="cyan" data-tint-win10="win10-03" data-bg="light" data-bg-wp="dark" ontouchend="">

	
		<div class="view" id="view-test2">
			<div class="view-inner" onclick="if(body.classList.contains('task-view-open')){taskView(this)}">
			
		
				<div class="menus">
					<div class="menu tiles menu-active slide-in done" data-menu="index" data-tiles="index" style="opacity: 1; -webkit-transform: translateX(0px);">
						
						
		
					</div>
				</div>
				
			</div>
		</div>

		<footer class="tablet-">
			<div class="navigate-back" onclick="if(!$('body').classList.contains('task-view-open')){app.currentView.back()}else{taskView()}"></div>
			<div class="home"></div>
			<div class="search" onclick="if(window.isPhone){taskView()}"></div>
			<div class="task-view" onclick="taskView()"></div>
		</footer>
		
		
		<script src="build/js/Bridge.d.ts"></script>
		<script src="build/js/appList.js"></script>
		<script>
			var app = new MetroUI({
				useLegacyInit: false
			});
			

				var view_1 = new MetroUI.View({
					app: app,
					selector: "div.view#view-test"
				});
				var view_2 = new MetroUI.View({
					app: app,
					selector: "div.view#view-test2"
				});
				app.currentView = view_1;


			window.onerror = function(e,url,line) { app.alert("MetroUI has encountered an error.","<br><pre>Script:	"+url+"</pre>"+"<pre>Line:		"+line+"</pre>"+"<pre>Error:	"+e+"</pre>"+"<pre>Source:	JavaScript Runtime Error</pre>") };
			
			function taskView(newView) {
				var viewCount = $$("div.view").length;
				var positionsX = [];
				var positionsY = [];
				var duration = 400;

				switch (viewCount) {
					case 1:
						positionsX = [0];
						positionsY = [0];
						break;
					case 2:
						positionsX = [-((window.innerWidth*0.4)/2 + 6),((window.innerWidth*0.4)/2 + 6)];
						positionsY = [0,0];
						break;
					case 3:
						positionsX = [-((window.innerWidth*0.4)/2 + 6),((window.innerWidth*0.4)/2 + 6),0];
						positionsY = [-((window.innerHeight*0.4)/2+6),-((window.innerHeight*0.4)/2+6),((window.innerHeight*0.4)/2 + 6)];
						break;
					case 4:
						positionsX = [-((window.innerWidth*0.4)/2 + 6),((window.innerWidth*0.4)/2 + 6),-((window.innerWidth*0.4)/2 + 6),((window.innerWidth*0.4)/2 + 6)];
						positionsY = [-((window.innerHeight*0.4)/2 + 6),-((window.innerHeight*0.4)/2 + 6),((window.innerHeight*0.4)/2 + 6),((window.innerHeight*0.4)/2 + 6)];
						break;
					case 5:
						var zoom = 0.3;
						positionsX = [	-((window.innerWidth*zoom) + 12),
										0,
										((window.innerWidth*zoom) + 12),
										-((window.innerWidth*zoom)/2 + 6),
										((window.innerWidth*zoom)/2 + 6)];

						positionsY = [	-((window.innerHeight*zoom)/2 + 3),
										-((window.innerHeight*zoom)/2 + 3),
										-((window.innerHeight*zoom)/2 + 3),
										((window.innerHeight*zoom)/2),
										((window.innerHeight*zoom)/2)];
						break;
					case 6:
						var zoom = 0.3;
						positionsX = [-((window.innerWidth*zoom) + 12),0,((window.innerWidth*zoom) + 12),-((window.innerWidth*zoom) + 12),0,((window.innerWidth*zoom) + 12)];
						positionsY = [-((window.innerHeight*zoom)/2 + 3),-((window.innerHeight*zoom)/2 + 3),-((window.innerHeight*zoom)/2 + 3),((window.innerHeight*zoom)/2),((window.innerHeight*zoom)/2),((window.innerHeight*zoom)/2)];
						break;
					case 7:
						var zoom = 0.3;
						positionsX = [-((window.innerWidth*zoom) + 12),0,((window.innerWidth*zoom) + 12),-((window.innerWidth*zoom) + 12),0,((window.innerWidth*zoom) + 12),0];
						positionsY = [-((window.innerHeight*zoom)),-((window.innerHeight*zoom)),-((window.innerHeight*zoom)),0,0,0,((window.innerHeight*zoom))];
						break;
					case 8:
						var zoom = 0.3;
						positionsX = [-((window.innerWidth*zoom) + 12),0,((window.innerWidth*zoom) + 12),-((window.innerWidth*zoom) + 12),0,((window.innerWidth*zoom) + 12),-((window.innerWidth*zoom)/2 + 6),((window.innerWidth*zoom)/2 + 6)];
						positionsY = [-((window.innerHeight*zoom)),-((window.innerHeight*zoom)),-((window.innerHeight*zoom)),0,0,0,((window.innerHeight*zoom)),((window.innerHeight*zoom))];
						break;
					case 9: 
						var zoom = 0.3;
						positionsX = [-((window.innerWidth*zoom) + 12),0,((window.innerWidth*zoom) + 12),-((window.innerWidth*zoom) + 12),0,((window.innerWidth*zoom) + 12),-((window.innerWidth*zoom) + 12),0,((window.innerWidth*zoom) + 12)];
						positionsY = [-((window.innerHeight*zoom)),-((window.innerHeight*zoom)),-((window.innerHeight*zoom)),0,0,0,((window.innerHeight*zoom)),((window.innerHeight*zoom)),((window.innerHeight*zoom))];
						break;
					default: break;
				}
				if (!$('body').classList.contains('task-view-open')) {
					if ($("footer div.task-view")) {
						$("footer div.task-view").classList.add('open');
					}
					$('body').classList.add('task-view-open');
					for (var i=0; i<viewCount; i++) {
						
						new Velocity($$('div.view div.view-inner')[i], "stop");
						new Velocity($$('div.view div.view-inner')[i], {
							translateX: [positionsX[i],0],
							translateY: [positionsY[i],0],
							scale: [(viewCount<5)?0.4:0.3,1]
						}, {
							duration:duration,
							easing:[0.19, 1, 0.22, 1],
							/*complete: function(el) {
								var views = $$("div.view");
								var viewIndex;
								
								for (var j=0; j<views.length; j++) {
									if (el[0].parentNode == views[j]) {
										viewIndex = j;
										break;
									}
								}
								if ($$("img.view-icon")[viewIndex]) {
									$$("img.view-icon")[viewIndex].style.marginTop = (positionsY[viewIndex]<=0) ? positionsY[viewIndex]-(window.innerHeight*((viewCount<5)?0.4:0.3) / 2) - 21 + "px" : 0 + "px";
									$$("img.view-icon")[viewIndex].style.marginLeft = (positionsX[viewIndex]<=0) ? positionsX[viewIndex]-(window.innerWidth*((viewCount<5)?0.4:0.3) / 2) + "px" : positionsX[viewIndex]-(window.innerWidth*((viewCount<5)?0.4:0.3) / 2) + "px";
								}
								if ($$("p.view-title")[viewIndex]) {
									$$("p.view-title")[viewIndex].style.marginTop = (positionsY[viewIndex]<=0) ? positionsY[viewIndex]-(window.innerHeight*((viewCount<5)?0.4:0.3) / 2) - 21 + "px" : 0 + "px";
									$$("p.view-title")[viewIndex].style.marginLeft = (positionsX[viewIndex]<=0) ? positionsX[viewIndex]-(window.innerWidth*((viewCount<5)?0.4:0.3) / 2) + 30 + "px" : positionsX[viewIndex]-(window.innerWidth*((viewCount<5)?0.4:0.3) / 2) + 30 + "px";
								}

							}*/
						});
					}
				} else {
					if ($("footer div.task-view")) {
						$("footer div.task-view").classList.remove('open');
					}
					$('body').classList.remove('task-view-open');
					for (var i=0; i<viewCount; i++) {
						new Velocity($$('div.view div.view-inner')[i], "stop");
					}
					var view = (typeof(newView) === "undefined") ? $('div.view.view-active div.view-inner') : newView;
					app.currentView = app.views[app.viewNames.indexOf("div.view#"+view.parentNode.getAttribute("id"))];

					$("div.view.view-active").classList.remove("view-active");
					view.parentNode.classList.add("view-active");

					new Velocity(view, {
						translateX: 0,
						translateY: 0,
						scale: [1,(viewCount<5)?0.4:0.3]
					}, {
						duration:duration,
						easing:[0.19, 1, 0.22, 1]
					});
				}
			} 

			app.onPageInit("pivot", function() {
				if (window.pivot) {
					window.pivot.destroy();
					window.pivot = undefined;
				}
				window.pivot = new MetroUI.Pivot("pivot");
				
				console.log("populating apps")
				const apst = document.getElementById('mainAppList');
				apst.innerHTML = ''; // Clear existing content
				applist.forEach(app => {
					const listItem = document.createElement('li');
					listItem.textContent = app.label;
					listItem.addEventListener('click', function() {
						// Call a method when an item is clicked (replace with your method)
						launchApp(app.packageName);
					});
					apst.appendChild(listItem);
				});
			});


			app.onPageInit("splitview", function() {
				var split = new MetroUI.SplitControl("splitview", {
					app: app
				});
			});
			app.onPageInit("hub", function() {
				window.hub = new MetroUI.Hub("hub");
			});
			window.addEventListener("touchend", function() {
				_$("div.menus p").css('display','run-in'); setTimeout(function () { _$("div.menus p").css('display','block'); }, 0);
			})
		</script>
	</body>
</html>